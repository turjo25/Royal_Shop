{% extends 'base.html' %}

{% block content %}
<div class="flex flex-col md:flex-row gap-8 mt-8">
    <div class="w-full md:w-1/4">
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 text-center mb-6">
            <div class="w-20 h-20 bg-indigo-100 rounded-full flex items-center justify-center mx-auto text-indigo-600 text-2xl mb-3">
                <i class="fas fa-user"></i>
            </div>
            <h3 class="font-bold text-gray-900">{{ user.first_name }} {{ user.last_name }}</h3>
            <p class="text-gray-500 text-sm">{{ user.email }}</p>
            <div class="mt-4 pt-4 border-t">
                <p class="text-xs text-gray-400 uppercase tracking-wider">Total Spent</p>
                <p class="text-xl font-bold text-indigo-600">৳{{ total_spent }}</p>
            </div>
        </div>

        <nav class="space-y-2">
            <a href="?tab=dashboard" class="block px-4 py-2 rounded-lg font-medium transition {% if not order_history_active %}bg-indigo-600 text-white shadow{% else %}bg-white text-gray-600 hover:bg-gray-50{% endif %}">
                <i class="fas fa-tachometer-alt mr-2"></i> Dashboard
            </a>
            <a href="?tab=orders" class="block px-4 py-2 rounded-lg font-medium transition {% if order_history_active %}bg-indigo-600 text-white shadow{% else %}bg-white text-gray-600 hover:bg-gray-50{% endif %}">
                <i class="fas fa-box-open mr-2"></i> Order History
            </a>
        </nav>
    </div>

    <div class="w-full md:w-3/4">
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8 min-h-[400px]">
            {% if order_history_active %}
                <h2 class="text-xl font-bold text-gray-900 mb-6">Order History</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full text-left text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 font-medium text-gray-500">Order ID</th>
                                <th class="px-4 py-3 font-medium text-gray-500">Date</th>
                                <th class="px-4 py-3 font-medium text-gray-500">Total</th>
                                <th class="px-4 py-3 font-medium text-gray-500">Status</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            {% for order in orders %}
                            <tr>
                                <td class="px-4 py-3 font-mono text-gray-600">#{{ order.id }}</td>
                                <td class="px-4 py-3 text-gray-600">{{ order.created_at|date:"M d, Y" }}</td>
                                <td class="px-4 py-3 font-medium text-gray-900">৳{{ order.get_total_cost }}</td>
                                <td class="px-4 py-3">
                                    <span class="px-2 py-1 rounded-full text-xs font-semibold 
                                        {% if order.status == 'delivered' %} bg-green-100 text-green-800
                                        {% elif order.status == 'canceled' %} bg-red-100 text-red-800
                                        {% else %} bg-blue-100 text-blue-800 {% endif %}">
                                        {{ order.status|title }}
                                    </span>
                                </td>
                            </tr>
                            {% empty %}
                            <tr><td colspan="4" class="px-4 py-4 text-center text-gray-500">No orders found.</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <h2 class="text-xl font-bold text-gray-900 mb-4">Dashboard Overview</h2>
                <p class="text-gray-600 mb-6">Welcome back to your profile. Here you can track your recent purchases and manage your account.</p>
                
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                        <p class="text-blue-600 text-sm font-medium">Total Orders</p>
                        <p class="text-2xl font-bold text-blue-800">{{ orders.count }}</p>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg border border-green-100">
                        <p class="text-green-600 text-sm font-medium">Completed</p>
                        <p class="text-2xl font-bold text-green-800">{{ completed_orders.count }}</p>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}